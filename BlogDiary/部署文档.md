# 本博客部署文档
## 部署环境
* 腾讯云服务器	OpenCloudOS 9.2 x86_64(Py3.7.16)	2h2g+50gSSD+4MBPS
* 宝塔Linux面板9.2.0
* 七牛云对象存储空间
## 部署之前你需要做什么
### 准备一个域名
各种成熟的云服务厂商，已经为域名的购买注册提供了非常便捷的服务。以我这个域名为例，购买可能只花了几分钟
链接如下
[去这里买域名](https://buy.cloud.tencent.com/domain)
一般来说，.com的会贵很多，量力而为吧。
我买的就是比较冷门的域名
### 准备一个服务器
一台*轻量级应用服务器*就足以应对这个小博客的大部分需求了
实例规格 CPU - 2核 内存 - 2GB 系统盘 - SSD云硬盘 50GB 流量包 - 300GB（带宽：4Mbps）

一个月五十几块钱就能用。当然这个小服务器的极限在哪我也不知道。至少我用了几个月，直到写这篇文章的时候，仍然能用。

### 备案一个域名

备案域名分为两个部分，首先你需要将你的域名去工信部进行备案

这一部分的备案工作比较繁琐，你需要准备一些你的个人资料。具体是什么，我相信你既然都准备好自己建站了，肯定会知道如何根据工信部网站的指引，来提供你的个人信息的。

下面的链接，是腾讯云教你怎么进行备案的：

[备案教程](https://cloud.tencent.com/document/product/243/97668)

icp备案结束之后，你可以开始去准备网安备案了

[网安备案教程](https://cloud.tencent.com/document/product/243/19142)

备案结束之后，你就完成了绝大部分和代码无关的内容了，下面你就可以安心进行你的项目的部署了。

## 部署过程

本次部署的过程仅以我这个博客为例，针对部署过程当中出现的问题，我也在这篇文档当中做记录。

### 首先打开你的宝塔面板吧！

### 前端上传



好的打开了

先看看你的java version

我的是19.0.2

这个是你要记得去在环境变量当中配置一下。我的是历史遗留问题，重新配置了一下java的路径。

然后呢，去“文件”的"www/wwwroot"当中新建一个文件夹”backend“这个文件夹之后会很有用。

为后台添加一个解析域名，

记录值为ip地址

在bt面板当中添加两个html项目，分别是前台和后台

域名根据你自己的来

根目录就是我们上面设置的那个

之后，就将前端项目打包，上传到根目录

基本都是打包成压缩包，然后上传解压

就能在网址之下，看到你的前端页面了

但是这个博客后台的前端页面有一个问题需要修改

~~~~js
/**
 * If you don't want to use mock-server
 * you want to use MockJs for mock api
 * you can execute: mockXHR()
 *
 * Currently MockJs will be used in the production environment,
 * please remove it before going online ! ! !
 */
// if (process.env.NODE_ENV === 'production') {
//   const { mockXHR } = require('../mock')
//   mockXHR()
// }
~~~~

当然，这段代码已经被注释掉了。在注释掉之后，可以正常的build

通义千问对这段代码描述如下：

生产环境中启用或禁用MockJs来模拟API请求的。MockJs是一个用于前端开发中模拟数据的JavaScript库，它可以帮助开发者在后端接口尚未完成或者为了测试目的时，模拟出所需的API响应。

在你的代码片段中，有一个条件注释块，检查`process.env.NODE_ENV`是否等于'production'（即是否为生产环境）。如果条件满足，那么会从相对路径`../mock`中引入`mockXHR`函数，并调用它来激活MockJs的数据模拟功能。

这样就可以了

### 数据库上传

记得去把测试数据该删的删，该修改的修改

数据库直接另存为就可以了

把所有的字符集都改为utf8mb4（原先是mb3）

在application.yml当中，修改一下数据库链接的配置

比如我们在学习如何设置这篇博客的过程中，只有一个application.yml文件。但我们在真正的部署过程中，最好区分dev和prod环境的配置文件

prod配置文件当中，把连接数据库的用户名和密码，换成宝塔面板里面的

### 后端

去maven里面package

上传打包的jar包到我们之前创建的backend文件夹当中

对于pom文件有一些调整，在这里面我就不详细写出了。主要是buid方面的配置

记得前台和后台的后端分别黄建一个文件夹

再去创建一个jaba项目，选择刚才上传的jar包

项目端口8989

执行命令后面加上

~~~~
--spring profiles.active=prod
~~~~

让jar包执行生产环境的配置

添加完项目之后，去html项目当中

添加伪静态配置

`location /prod-api/{`

`proxy_pass http://localhost:7777}`

前台和后台的前端文件都这样添加

端口号记得区分一下

